@model IEnumerable<ArandanoIRT.Web._1_Application.DTOs.Admin.PlantStatusHistoryDto>

@{
    ViewData["Title"] = "Historial de Estados de Plantas";
    Layout = "_AdminLayout";
}

<h1>@ViewData["Title"]</h1>
<p>Consulta todos los cambios de estado que han ocurrido en las plantas.</p>

@* SECCIÓN DE FILTROS (funcionalidad simplificada) *@
<form asp-action="History" method="get" class="card p-3 mb-4">
    <div class="row">
        <div class="col-md-3">
            <label class="form-label">Planta</label>
            @* Aquí iría un dropdown para filtrar por planta *@
            <select name="plantId" class="form-select" asp-items="@ViewBag.Plants">
                <option value="">Todas</option>
            </select>
        </div>
        <div class="col-md-3">
            <label class="form-label">Fecha Inicio</label>
            <input type="date" name="startDate" class="form-control"/>
        </div>
        <div class="col-md-3">
            <label class="form-label">Fecha Fin</label>
            <input type="date" name="endDate" class="form-control"/>
        </div>
        <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn btn-primary w-100">Filtrar</button>
        </div>
    </div>
</form>


@if (!Model.Any())
{
    <div class="alert alert-info">No hay registros en el historial que coincidan con los filtros.</div>
}
else
{
    <table class="table table-striped table-hover">
        <thead class="table-dark">
        <tr>
            <th>@Html.DisplayNameFor(model => model.First().ChangedAt)</th>
            <th>@Html.DisplayNameFor(model => model.First().PlantName)</th>
            <th>@Html.DisplayNameFor(model => model.First().Status)</th>
            <th>@Html.DisplayNameFor(model => model.First().Source)</th>
            <th>@Html.DisplayNameFor(model => model.First().Observation)</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.ChangedAt.ToString("g")</td>
                <td>@Html.DisplayFor(modelItem => item.PlantName)</td>
                <td>@Html.DisplayFor(modelItem => item.Status)</td>
                <td>@Html.DisplayFor(modelItem => item.Source)</td>
                <td>@Html.DisplayFor(modelItem => item.Observation)</td>
            </tr>
        }
        </tbody>
    </table>
}