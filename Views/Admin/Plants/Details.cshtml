@using ArandanoIRT.Web._0_Domain.Common
@using ArandanoIRT.Web._0_Domain.Enums
@model ArandanoIRT.Web._1_Application.DTOs.Plants.PlantDetailsDto
@{
    ViewData["Title"] = "Detalles de la Planta";
    Layout = "_AdminLayout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/plantDetails.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
}

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

@if (Model == null)
{
    <div class="alert alert-warning">Planta no encontrada.</div>
    <p><a asp-action="Index" class="btn btn-secondary">Volver al listado</a></p>
}
else
{
    <div class="card details-card">
        <div class="details-header">
            <h1>@ViewData["Title"]</h1>
            <h4>@Model.Name</h4>
        </div>
        
        <div class="card-body">
            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger" role="alert">@TempData["ErrorMessage"]</div>
            }
            
            <dl class="details-list">
                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.Name)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.Name)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">Estado Actual</dt>
                    <dd class="col-sm-8 col-md-9">
                        @{
                            var statusClass = Model.Status switch
                            {
                                PlantStatus.OPTIMAL => "status-healthy",
                                PlantStatus.MILD_STRESS => "status-mild-stress",
                                PlantStatus.SEVERE_STRESS => "status-severe-stress",
                                PlantStatus.RECOVERING => "status-recovering",
                                _ => "status-default"
                            };
                        }
                        <span class="status-badge @statusClass">@Model.Status.GetDisplayName()</span>
                    </dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.ExperimentalGroup)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.ExperimentalGroup)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.CropName)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.CropName)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.CropCityName)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.CropCityName)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.RegisteredAt)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.RegisteredAt)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-4 col-md-3">@Html.DisplayNameFor(model => model.UpdatedAt)</dt>
                    <dd class="col-sm-8 col-md-9">@Html.DisplayFor(model => model.UpdatedAt)</dd>
                </div>
            </dl>
        </div>

        <div class="card-footer actions-bar">
            <a asp-action="Edit" asp-route-id="@Model.Id" class="action-btn btn-edit">
                <i class="fas fa-pencil-alt"></i> Editar
            </a>
            <a asp-action="Change" asp-controller="PlantStatus" asp-route-id="@Model.Id" class="action-btn btn-status">
                <i class="fas fa-exchange-alt"></i> Cambiar Estado
            </a>
            <a asp-action="CreateMask" asp-controller="Analytics" asp-route-id="@Model.Id" class="action-btn btn-mask">
                <i class="fas fa-draw-polygon"></i> Máscara Térmica
            </a>
            <a asp-action="Index" class="action-btn btn-back ms-md-auto">
                 Volver al Listado
            </a>
        </div>
    </div>
}
