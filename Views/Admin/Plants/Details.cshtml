@model ArandanoIRT.Web._1_Application.DTOs.Plants.PlantDetailsDto
@{
    ViewData["Title"] = "Detalles de la Planta";
    Layout = "_AdminLayout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/crud-forms.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

}

@if (Model == null)
{
    <div class="alert alert-warning">Planta no encontrada.</div>
    <p><a asp-action="Index" class="btn btn-secondary-outline">Volver al listado</a></p>
}
else
{
    <div class="page-header">
        <h1>@ViewData["Title"]</h1>
        <h4>@Model.Name</h4>
    </div>

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger" role="alert">@TempData["ErrorMessage"]</div>
    }

    <div class="card details-card">
        <div class="card-body">
            <dl class="details-list">
                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.Name)</dt>
                    <dd class="col-sm-9">@Html.DisplayFor(model => model.Name)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">Estado Actual</dt>
                    <dd class="col-sm-9">
                        @{
                            var statusClass = "status-default";
                            var statusName = Model.StatusName ?? "Desconocido";
                            var status = statusName.ToLower().Trim();
                            if (status == "saludable") { statusClass = "status-healthy"; }
                            else if (status == "estrés leve") { statusClass = "status-mild-stress"; }
                            else if (status == "estrés severo") { statusClass = "status-severe-stress"; }
                            else if (status == "en recuperación") { statusClass = "status-recovering"; }
                        }
                        <span class="status-badge @statusClass">@statusName</span>
                    </dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.ExperimentalGroup)</dt>
                    <dd class="col-sm-9">@Html.DisplayFor(model => model.ExperimentalGroup)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.CropName)</dt>
                    <dd class="col-sm-9">@Html.DisplayFor(model => model.CropName)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.CropCityName)</dt>
                    <dd class="col-sm-9">@Html.DisplayFor(model => model.CropCityName)</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.RegisteredAt)</dt>
                    <dd class="col-sm-9">@Model.RegisteredAt.ToString("dd/MM/yyyy HH:mm")</dd>
                </div>

                <div class="row detail-item">
                    <dt class="col-sm-3">@Html.DisplayNameFor(model => model.UpdatedAt)</dt>
                    <dd class="col-sm-9">@Model.UpdatedAt.ToString("dd/MM/yyyy HH:mm")</dd>
                </div>
            </dl>
        </div>
        <div class="mt-3">
            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">Editar</a> |
            <a asp-action="Change" asp-controller="PlantStatus" asp-route-id="@Model.Id" class="btn btn-warning">
                <i class="fas fa-exchange-alt"></i> Cambiar Estado
            </a> |
            <a asp-action="CreateMask" asp-controller="Analytics" asp-route-id="@Model.Id" class="btn btn-info">
                <i class="fas fa-draw-polygon"></i> Crear/Editar Máscara Térmica
            </a> |
            <a asp-action="Index" class="btn btn-secondary">Volver al Listado</a>
        </div>
    </div>
}
